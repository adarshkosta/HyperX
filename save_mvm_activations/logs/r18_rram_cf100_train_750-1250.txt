WARNING: crossbar sizes with different row annd column dimension not supported.

      ==> Arguments:
          batch_size: 40
          dataset: cifar100
          savedir: /home/nano01/a/esoufler/activations/x64/rram/multiple_batches/
          model: resnet18
          pretrained: ../pretrained_models/ideal/resnet18fp_imnet.pth.tar
          mvm: True
          nideal: True
          mode: train
          input_size: None
          workers: 8
          gpus: 0,1,2,3
          experiment: 64x64
          batch_start: 750

      ==> Functional simulator configurations:
          weight_bits=16
          weight_bit_frac=12
          input_bits=16
          input_bit_frac=12
          xbar_row_size=64
          xbar_col_size=64
          tile_row=custom
          tile_col=custom
          bit_stream=1
          bit_slice=2
          adc_bit=14
          acm_bits=32
          acm_bit_frac=24
          mvm=True
          non-ideality=True
          
xbmodel=NN_model(
  (fc1): Linear(in_features=4160, out_features=500, bias=True)
  (relu1): ReLU(inplace=True)
  (do2): Dropout(p=0.5, inplace=False)
  (fc3): Linear(in_features=500, out_features=64, bias=True)
)
          
xbmodel_weight_path=../xb_models/XB_64_stream1slice207dropout50epochs.pth.tar
          inmax_test=1.2
          inmin_test=0.857


DEVICE: cuda
4 GPU devices being used. ID(s) 0,1,2,3
==> Building model and model_mvm for resnet18 ...
WARNING: crossbar sizes with different row annd column dimension not supported.
==> Initializing model parameters ...
==> Load pretrained model form ../pretrained_models/ideal/resnet18fp_imnet.pth.tar ...
Pretrained model accuracy: 69.93189239501953
Files already downloaded and verified
Files already downloaded and verified
Saving activations to: /home/nano01/a/esoufler/activations/x64/rram/multiple_batches/cifar100/resnet18/train
Dry run for computing activation sizes...
Dry run finished...
relu1: torch.Size([10, 64, 112, 112])
relu2: torch.Size([10, 64, 56, 56])
relu3: torch.Size([10, 64, 56, 56])
relu4: torch.Size([10, 64, 56, 56])
relu5: torch.Size([10, 64, 56, 56])
relu6: torch.Size([10, 128, 28, 28])
relu7: torch.Size([10, 128, 28, 28])
relu8: torch.Size([10, 128, 28, 28])
relu9: torch.Size([10, 128, 28, 28])
relu10: torch.Size([10, 256, 14, 14])
relu11: torch.Size([10, 256, 14, 14])
relu12: torch.Size([10, 256, 14, 14])
relu13: torch.Size([10, 256, 14, 14])
relu14: torch.Size([10, 512, 7, 7])
relu15: torch.Size([10, 512, 7, 7])
relu16: torch.Size([10, 512, 7, 7])
relu17: torch.Size([10, 512, 7, 7])
fc: torch.Size([10, 100])
relu1: torch.Size([40, 64, 112, 112])
relu2: torch.Size([40, 64, 56, 56])
relu3: torch.Size([40, 64, 56, 56])
relu4: torch.Size([40, 64, 56, 56])
relu5: torch.Size([40, 64, 56, 56])
relu6: torch.Size([40, 128, 28, 28])
relu7: torch.Size([40, 128, 28, 28])
relu8: torch.Size([40, 128, 28, 28])
relu9: torch.Size([40, 128, 28, 28])
relu10: torch.Size([40, 256, 14, 14])
relu11: torch.Size([40, 256, 14, 14])
relu12: torch.Size([40, 256, 14, 14])
relu13: torch.Size([40, 256, 14, 14])
relu14: torch.Size([40, 512, 7, 7])
relu15: torch.Size([40, 512, 7, 7])
relu16: torch.Size([40, 512, 7, 7])
relu17: torch.Size([40, 512, 7, 7])
fc: torch.Size([40, 100])
Starting to save activations..
Start time:  1615158993.3298786
 750/1250 [===========>........] - ETA: 8:32 - DT: 15.8810 - FpT: 763.9191 - BT: 768.1297 751/1250 [===========>........] - ETA: 17:01 - DT: 15.8704 - FpT: 763.9201 - BT: 768.1307 752/1250 [===========>........] - ETA: 25:26 - DT: 15.8564 - FpT: 763.9201 - BT: 768.1307 753/1250 [===========>........] - ETA: 33:46 - DT: 15.8406 - FpT: 763.9193 - BT: 768.1299 754/1250 [===========>........] - ETA: 42:03 - DT: 15.8238 - FpT: 763.9182 - BT: 768.1287 755/1250 [===========>........] - ETA: 50:20 - DT: 15.8063 - FpT: 763.9180 - BT: 768.1284 756/1250 [===========>........] - ETA: 58:36 - DT: 15.7884 - FpT: 763.9188 - BT: 768.1292 757/1250 [===========>........] - ETA: 1:06:41 - DT: 15.7702 - FpT: 763.9188 - BT: 768.1290 758/1250 [===========>........] - ETA: 1:14:45 - DT: 15.7517 - FpT: 763.9185 - BT: 768.1287 759/1250 [===========>........] - ETA: 1:22:47 - DT: 15.7331 - FpT: 763.9183 - BT: 768.1283 760/1250 [===========>........] - ETA: 1:30:49 - DT: 15.7143 - FpT: 763.9187 - BT: 768.1287 761/1250 [===========>........] - ETA: 1:38:43 - DT: 15.6954 - FpT: 763.9189 - BT: 768.1288 762/1250 [===========>........] - ETA: 1:46:42 - DT: 15.6764 - FpT: 763.9200 - BT: 768.1301 763/1250 [===========>........] - ETA: 1:54:35 - DT: 15.6573 - FpT: 763.9213 - BT: 768.1318 764/1250 [===========>........] - ETA: 2:02:19 - DT: 15.6382 - FpT: 763.9220 - BT: 768.1332 765/1250 [===========>........] - ETA: 2:10:05 - DT: 15.6191 - FpT: 763.9232 - BT: 768.1349 766/1250 [===========>........] - ETA: 2:17:46 - DT: 15.5999 - FpT: 763.9245 - BT: 768.1368 767/1250 [===========>........] - ETA: 2:25:20 - DT: 15.5808 - FpT: 763.9255 - BT: 768.1384 768/1250 [===========>........] - ETA: 2:32:55 - DT: 15.5616 - FpT: 763.9268 - BT: 768.1401 769/1250 [===========>........] - ETA: 2:40:22 - DT: 15.5424 - FpT: 763.9277 - BT: 768.1415 770/1250 [===========>........] - ETA: 2:47:52 - DT: 15.5232 - FpT: 763.9290 - BT: 768.1432 771/1250 [===========>........] - ETA: 2:55:16 - DT: 15.5040 - FpT: 763.9303 - BT: 768.1449 772/1250 [===========>........] - ETA: 3:02:41 - DT: 15.4848 - FpT: 763.9319 - BT: 768.1469 773/1250 [===========>........] - ETA: 3:09:59 - DT: 15.4656 - FpT: 763.9336 - BT: 768.1490 774/1250 [===========>........] - ETA: 3:17:11 - DT: 15.4465 - FpT: 763.9351 - BT: 768.1508 775/1250 [===========>........] - ETA: 3:24:23 - DT: 15.4273 - FpT: 763.9367 - BT: 768.1527