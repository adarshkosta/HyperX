WARNING: crossbar sizes with different row annd column dimension not supported.

      ==> Arguments:
          batch_size: 40
          dataset: cifar100
          savedir: /home/nano01/a/esoufler/activations/x64/rram/multiple_batches/
          model: resnet18
          pretrained: ../pretrained_models/ideal/resnet18fp_imnet.pth.tar
          mvm: True
          nideal: True
          mode: train
          input_size: None
          workers: 8
          gpus: 0,1,2,3
          experiment: 64x64
          batch_start: 150

      ==> Functional simulator configurations:
          weight_bits=16
          weight_bit_frac=12
          input_bits=16
          input_bit_frac=12
          xbar_row_size=64
          xbar_col_size=64
          tile_row=custom
          tile_col=custom
          bit_stream=1
          bit_slice=2
          adc_bit=14
          acm_bits=32
          acm_bit_frac=24
          mvm=True
          non-ideality=True
          
xbmodel=NN_model(
  (fc1): Linear(in_features=4160, out_features=500, bias=True)
  (relu1): ReLU(inplace=True)
  (do2): Dropout(p=0.5, inplace=False)
  (fc3): Linear(in_features=500, out_features=64, bias=True)
)
          
xbmodel_weight_path=../xb_models/XB_64_stream1slice207dropout50epochs.pth.tar
          inmax_test=1.2
          inmin_test=0.857


DEVICE: cuda
4 GPU devices being used. ID(s) 0,1,2,3
==> Building model and model_mvm for resnet18 ...
WARNING: crossbar sizes with different row annd column dimension not supported.
==> Initializing model parameters ...
==> Load pretrained model form ../pretrained_models/ideal/resnet18fp_imnet.pth.tar ...
Pretrained model accuracy: 69.93189239501953
Files already downloaded and verified
Files already downloaded and verified
Saving activations to: /home/nano01/a/esoufler/activations/x64/rram/multiple_batches/cifar100/resnet18/train
Dry run for computing activation sizes...
Dry run finished...
relu1: torch.Size([10, 64, 112, 112])
relu2: torch.Size([10, 64, 56, 56])
relu3: torch.Size([10, 64, 56, 56])
relu4: torch.Size([10, 64, 56, 56])
relu5: torch.Size([10, 64, 56, 56])
relu6: torch.Size([10, 128, 28, 28])
relu7: torch.Size([10, 128, 28, 28])
relu8: torch.Size([10, 128, 28, 28])
relu9: torch.Size([10, 128, 28, 28])
relu10: torch.Size([10, 256, 14, 14])
relu11: torch.Size([10, 256, 14, 14])
relu12: torch.Size([10, 256, 14, 14])
relu13: torch.Size([10, 256, 14, 14])
relu14: torch.Size([10, 512, 7, 7])
relu15: torch.Size([10, 512, 7, 7])
relu16: torch.Size([10, 512, 7, 7])
relu17: torch.Size([10, 512, 7, 7])
fc: torch.Size([10, 100])
relu1: torch.Size([40, 64, 112, 112])
relu2: torch.Size([40, 64, 56, 56])
relu3: torch.Size([40, 64, 56, 56])
relu4: torch.Size([40, 64, 56, 56])
relu5: torch.Size([40, 64, 56, 56])
relu6: torch.Size([40, 128, 28, 28])
relu7: torch.Size([40, 128, 28, 28])
relu8: torch.Size([40, 128, 28, 28])
relu9: torch.Size([40, 128, 28, 28])
relu10: torch.Size([40, 256, 14, 14])
relu11: torch.Size([40, 256, 14, 14])
relu12: torch.Size([40, 256, 14, 14])
relu13: torch.Size([40, 256, 14, 14])
relu14: torch.Size([40, 512, 7, 7])
relu15: torch.Size([40, 512, 7, 7])
relu16: torch.Size([40, 512, 7, 7])
relu17: torch.Size([40, 512, 7, 7])
fc: torch.Size([40, 100])
Starting to save activations..
Start time:  1615065095.56089
 150/1250 [=>..................] - ETA: 1:33:26 - DT: 5.8441 - FpT: 756.3522 - BT: 764.4671 151/1250 [=>..................] - ETA: 3:06:09 - DT: 5.8247 - FpT: 756.3771 - BT: 764.4862 152/1250 [=>..................] - ETA: 4:37:22 - DT: 5.7992 - FpT: 756.4038 - BT: 764.5091 153/1250 [=>..................] - ETA: 6:07:22 - DT: 5.7709 - FpT: 756.4342 - BT: 764.5356 154/1250 [=>..................] - ETA: 7:36:25 - DT: 5.7411 - FpT: 756.4700 - BT: 764.5684 155/1250 [=>..................] - ETA: 9:02:56 - DT: 5.7103 - FpT: 756.5021 - BT: 764.5941 156/1250 [=>..................] - ETA: 10:28:42 - DT: 5.6791 - FpT: 756.5356 - BT: 764.6188 157/1250 [=>..................] - ETA: 11:53:45 - DT: 5.6476 - FpT: 756.5735 - BT: 764.6462 158/1250 [=>..................] - ETA: 13:17:23 - DT: 5.6160 - FpT: 756.6133 - BT: 764.6748 159/1250 [=>..................] - ETA: 14:39:51 - DT: 5.5844 - FpT: 756.6539 - BT: 764.7043 160/1250 [=>..................] - ETA: 16:01:05 - DT: 5.5528 - FpT: 756.6960 - BT: 764.7344 161/1250 [=>..................] - ETA: 17:21:10 - DT: 5.5214 - FpT: 756.7393 - BT: 764.7649 162/1250 [=>..................] - ETA: 18:39:50 - DT: 5.4901 - FpT: 756.7823 - BT: 764.7946 163/1250 [=>..................] - ETA: 19:57:33 - DT: 5.4590 - FpT: 756.8256 - BT: 764.8243 164/1250 [=>..................] - ETA: 21:14:08 - DT: 5.4281 - FpT: 756.8691 - BT: 764.8537 165/1250 [=>..................] - ETA: 22:29:24 - DT: 5.3974 - FpT: 756.9118 - BT: 764.8820 166/1250 [=>..................] - ETA: 23:43:59 - DT: 5.3670 - FpT: 756.9550 - BT: 764.9107 167/1250 [=>..................] - ETA: 24:57:02 - DT: 5.3368 - FpT: 756.9970 - BT: 764.9381 168/1250 [=>..................] - ETA: 26:09:28 - DT: 5.3069 - FpT: 757.0387 - BT: 764.9655 169/1250 [=>..................] - ETA: 27:20:57 - DT: 5.2773 - FpT: 757.0799 - BT: 764.9930 170/1250 [=>..................] - ETA: 28:31:26 - DT: 5.2479 - FpT: 757.1214 - BT: 765.0207 171/1250 [=>..................] - ETA: 29:41:06 - DT: 5.2188 - FpT: 757.1635 - BT: 765.0488 172/1250 [=>..................] - ETA: 30:50:10 - DT: 5.1899 - FpT: 757.2062 - BT: 765.0782 173/1250 [=>..................] - ETA: 31:57:15 - DT: 5.1614 - FpT: 757.2478 - BT: 765.1062 174/1250 [=>..................] - ETA: 33:03:57 - DT: 5.1331 - FpT: 757.2894 - BT: 765.1342 175/1250 [=>..................] - ETA: 34:09:10 - DT: 5.1050 - FpT: 757.3298 - BT: 765.1610 176/1250 [=>..................] - ETA: 35:13:48 - DT: 5.0773 - FpT: 757.3697 - BT: 765.1872 177/1250 [=>..................] - ETA: 36:17:24 - DT: 5.0498 - FpT: 757.4088 - BT: 765.2125 178/1250 [=>..................] - ETA: 37:20:48 - DT: 5.0226 - FpT: 757.4484 - BT: 765.2383 179/1250 [=>..................] - ETA: 38:22:53 - DT: 4.9956 - FpT: 757.4875 - BT: 765.2637 180/1250 [=>..................] - ETA: 39:24:27 - DT: 4.9690 - FpT: 757.5267 - BT: 765.2892 181/1250 [=>..................] - ETA: 40:24:29 - DT: 4.9425 - FpT: 757.5648 - BT: 765.3136 182/1250 [=>..................] - ETA: 41:24:15 - DT: 4.9164 - FpT: 757.6027 - BT: 765.3378 183/1250 [=>..................] - ETA: 42:22:46 - DT: 4.8905 - FpT: 757.6397 - BT: 765.3611 184/1250 [=>..................] - ETA: 43:20:53 - DT: 4.8648 - FpT: 757.6764 - BT: 765.3842 185/1250 [=>..................] - ETA: 44:18:21 - DT: 4.8394 - FpT: 757.7127 - BT: 765.4071 186/1250 [=>..................] - ETA: 45:15:12 - DT: 4.8143 - FpT: 757.7488 - BT: 765.4302 187/1250 [=>..................] - ETA: 46:10:56 - DT: 4.7894 - FpT: 757.7841 - BT: 765.4529 188/1250 [==>.................] - ETA: 47:06:05 - DT: 4.7647 - FpT: 757.8192 - BT: 765.4754 189/1250 [==>.................] - ETA: 48:00:32 - DT: 4.7403 - FpT: 757.8541 - BT: 765.4976 190/1250 [==>.................] - ETA: 48:54:26 - DT: 4.7161 - FpT: 757.8890 - BT: 765.5199 191/1250 [==>.................] - ETA: 49:47:32 - DT: 4.6922 - FpT: 757.9233 - BT: 765.5421 192/1250 [==>.................] - ETA: 50:39:58 - DT: 4.6685 - FpT: 757.9574 - BT: 765.5642 193/1250 [==>.................] - ETA: 51:31:41 - DT: 4.6450 - FpT: 757.9908 - BT: 765.5861 194/1250 [==>.................] - ETA: 52:23:04 - DT: 4.6217 - FpT: 758.0242 - BT: 765.6084 195/1250 [==>.................] - ETA: 53:13:27 - DT: 4.5987 - FpT: 758.0572 - BT: 765.6304 196/1250 [==>.................] - ETA: 54:03:28 - DT: 4.5759 - FpT: 758.0900 - BT: 765.6526 197/1250 [==>.................] - ETA: 54:52:37 - DT: 4.5533 - FpT: 758.1224 - BT: 765.6746 198/1250 [==>.................] - ETA: 55:41:25 - DT: 4.5309 - FpT: 758.1546 - BT: 765.6969 199/1250 [==>.................] - ETA: 56:29:26 - DT: 4.5088 - FpT: 758.1866 - BT: 765.7191 200/1250 [==>.................] - ETA: 57:16:49 - DT: 4.4868 - FpT: 758.2183 - BT: 765.7413 201/1250 [==>.................] - ETA: 58:03:36 - DT: 4.4651 - FpT: 758.2496 - BT: 765.7635 202/1250 [==>.................] - ETA: 58:49:46 - DT: 4.4435 - FpT: 758.2809 - BT: 765.7855 203/1250 [==>.................] - ETA: 59:35:12 - DT: 4.4222 - FpT: 758.3116 - BT: 765.8073 204/1250 [==>.................] - ETA: 60:20:30 - DT: 4.4011 - FpT: 758.3422 - BT: 765.8293 205/1250 [==>.................] - ETA: 61:04:55 - DT: 4.3801 - FpT: 758.3723 - BT: 765.8512 206/1250 [==>.................] - ETA: 61:48:39 - DT: 4.3594 - FpT: 758.4018 - BT: 765.8728 207/1250 [==>.................] - ETA: 62:32:23 - DT: 4.3388 - FpT: 758.4313 - BT: 765.8947 208/1250 [==>.................] - ETA: 63:15:27 - DT: 4.3185 - FpT: 758.4607 - BT: 765.9167 209/1250 [==>.................] - ETA: 63:57:15 - DT: 4.2983 - FpT: 758.4893 - BT: 765.9381 210/1250 [==>.................] - ETA: 64:39:03 - DT: 4.2783 - FpT: 758.5177 - BT: 765.9595 211/1250 [==>.................] - ETA: 65:20:01 - DT: 4.2585 - FpT: 758.5455 - BT: 765.9806 212/1250 [==>.................] - ETA: 66:00:47 - DT: 4.2389 - FpT: 758.5732 - BT: 766.0015 213/1250 [==>.................] - ETA: 66:40:38 - DT: 4.2194 - FpT: 758.6003 - BT: 766.0221 214/1250 [==>.................] - ETA: 67:20:32 - DT: 4.2001 - FpT: 758.6273 - BT: 766.0426 215/1250 [==>.................] - ETA: 67:59:42 - DT: 4.1810 - FpT: 758.6541 - BT: 766.0631 216/1250 [==>.................] - ETA: 68:38:07 - DT: 4.1621 - FpT: 758.6804 - BT: 766.0831 217/1250 [==>.................] - ETA: 69:16:14 - DT: 4.1433 - FpT: 758.7065 - BT: 766.1029 218/1250 [==>.................] - ETA: 69:53:47 - DT: 4.1247 - FpT: 758.7322 - BT: 766.1223 219/1250 [==>.................] - ETA: 70:31:19 - DT: 4.1063 - FpT: 758.7579 - BT: 766.1419 220/1250 [==>.................] - ETA: 71:07:55 - DT: 4.0880 - FpT: 758.7833 - BT: 766.1610 221/1250 [==>.................] - ETA: 71:44:26 - DT: 4.0699 - FpT: 758.8085 - BT: 766.1802 222/1250 [==>.................] - ETA: 72:20:23 - DT: 4.0519 - FpT: 758.8334 - BT: 766.1992 223/1250 [==>.................] - ETA: 72:55:50 - DT: 4.0341 - FpT: 758.8581 - BT: 766.2180 224/1250 [==>.................] - ETA: 73:30:56 - DT: 4.0165 - FpT: 758.8825 - BT: 766.2368 225/1250 [==>.................] - ETA: 74:05:32 - DT: 3.9990 - FpT: 758.9066 - BT: 766.2553 226/1250 [==>.................] - ETA: 74:40:05 - DT: 3.9817 - FpT: 758.9307 - BT: 766.2740 227/1250 [==>.................] - ETA: 75:13:58 - DT: 3.9645 - FpT: 758.9546 - BT: 766.2925 228/1250 [==>.................] - ETA: 75:47:29 - DT: 3.9474 - FpT: 758.9784 - BT: 766.3110 229/1250 [==>.................] - ETA: 76:20:42 - DT: 3.9305 - FpT: 759.0021 - BT: 766.3296 230/1250 [==>.................] - ETA: 76:53:20 - DT: 3.9138 - FpT: 759.0256 - BT: 766.3480 231/1250 [==>.................] - ETA: 77:25:35 - DT: 3.8972 - FpT: 759.0489 - BT: 766.3663 232/1250 [==>.................] - ETA: 77:57:21 - DT: 3.8807 - FpT: 759.0719 - BT: 766.3844 233/1250 [==>.................] - ETA: 78:28:36 - DT: 3.8643 - FpT: 759.0947 - BT: 766.4023 234/1250 [==>.................] - ETA: 78:59:33 - DT: 3.8481 - FpT: 759.1174 - BT: 766.4199 235/1250 [==>.................] - ETA: 79:30:30 - DT: 3.8321 - FpT: 759.1399 - BT: 766.4377 236/1250 [==>.................] - ETA: 80:01:05 - DT: 3.8161 - FpT: 759.1623 - BT: 766.4554 237/1250 [==>.................] - ETA: 80:31:20 - DT: 3.8003 - FpT: 759.1848 - BT: 766.4733 238/1250 [==>.................] - ETA: 81:00:38 - DT: 3.7847 - FpT: 759.2068 - BT: 766.4908 239/1250 [==>.................] - ETA: 81:30:12 - DT: 3.7691 - FpT: 759.2288 - BT: 766.5084 240/1250 [==>.................] - ETA: 81:59:24 - DT: 3.7537 - FpT: 759.2508 - BT: 766.5260 241/1250 [==>.................] - ETA: 82:27:48 - DT: 3.7384 - FpT: 759.2726 - BT: 766.5435 242/1250 [==>.................] - ETA: 82:56:11 - DT: 3.7232 - FpT: 759.2944 - BT: 766.5609 243/1250 [==>.................] - ETA: 83:24:07 - DT: 3.7082 - FpT: 759.3162 - BT: 766.5782 244/1250 [==>.................] - ETA: 83:51:34 - DT: 3.6932 - FpT: 759.3378 - BT: 766.5954 245/1250 [==>.................] - ETA: 84:19:08 - DT: 3.6784 - FpT: 759.3594 - BT: 766.6127 246/1250 [==>.................] - ETA: 84:45:58 - DT: 3.6637 - FpT: 759.3809 - BT: 766.6298 247/1250 [==>.................] - ETA: 85:12:34 - DT: 3.6492 - FpT: 759.4024 - BT: 766.6468 248/1250 [==>.................] - ETA: 85:38:44 - DT: 3.6347 - FpT: 759.4237 - BT: 766.6637 249/1250 [==>.................] - ETA: 86:04:34 - DT: 3.6204 - FpT: 759.4449 - BT: 766.6804 250/1250 [===>................] - ETA: 86:30:17 - DT: 3.6061 - FpT: 759.4661 - BT: 766.6970 251/1250 [===>................] - ETA: 86:55:20 - DT: 3.5920 - FpT: 759.4870 - BT: 766.7133 252/1250 [===>................] - ETA: 87:20:37 - DT: 3.5780 - FpT: 759.5080 - BT: 766.7297 253/1250 [===>................] - ETA: 87:45:39 - DT: 3.5641 - FpT: 759.5291 - BT: 766.7462 254/1250 [===>................] - ETA: 88:10:17 - DT: 3.5503 - FpT: 759.5502 - BT: 766.7627 255/1250 [===>................] - ETA: 88:34:37 - DT: 3.5366 - FpT: 759.5714 - BT: 766.7791 256/1250 [===>................] - ETA: 88:58:40 - DT: 3.5230 - FpT: 759.5925 - BT: 766.7956 257/1250 [===>................] - ETA: 89:22:22 - DT: 3.5095 - FpT: 759.6137 - BT: 766.8121 258/1250 [===>................] - ETA: 89:45:43 - DT: 3.4962 - FpT: 759.6348 - BT: 766.8285 259/1250 [===>................] - ETA: 90:08:46 - DT: 3.4829 - FpT: 759.6559 - BT: 766.8448 260/1250 [===>................] - ETA: 90:31:48 - DT: 3.4697 - FpT: 759.6771 - BT: 766.8612 261/1250 [===>................] - ETA: 90:54:33 - DT: 3.4566 - FpT: 759.6983 - BT: 766.8776 262/1250 [===>................] - ETA: 91:17:01 - DT: 3.4436 - FpT: 759.7195 - BT: 766.8940 263/1250 [===>................] - ETA: 91:39:04 - DT: 3.4308 - FpT: 759.7408 - BT: 766.9105 264/1250 [===>................] - ETA: 92:01:04 - DT: 3.4180 - FpT: 759.7621 - BT: 766.9270 265/1250 [===>................] - ETA: 92:22:21 - DT: 3.4053 - FpT: 759.7833 - BT: 766.9433 266/1250 [===>................] - ETA: 92:43:38 - DT: 3.3927 - FpT: 759.8045 - BT: 766.9596 267/1250 [===>................] - ETA: 93:04:45 - DT: 3.3802 - FpT: 759.8256 - BT: 766.9759 268/1250 [===>................] - ETA: 93:25:31 - DT: 3.3678 - FpT: 759.8468 - BT: 766.9922 269/1250 [===>................] - ETA: 93:46:01 - DT: 3.3554 - FpT: 759.8679 - BT: 767.0084 270/1250 [===>................] - ETA: 94:06:11 - DT: 3.3432 - FpT: 759.8889 - BT: 767.0245 271/1250 [===>................] - ETA: 94:26:09 - DT: 3.3311 - FpT: 759.9099 - BT: 767.0406 272/1250 [===>................] - ETA: 94:45:58 - DT: 3.3190 - FpT: 759.9308 - BT: 767.0566 273/1250 [===>................] - ETA: 95:05:41 - DT: 3.3070 - FpT: 759.9518 - BT: 767.0727 274/1250 [===>................] - ETA: 95:25:08 - DT: 3.2951 - FpT: 759.9728 - BT: 767.0888 275/1250 [===>................] - ETA: 95:44:18 - DT: 3.2833 - FpT: 759.9938 - BT: 767.1049 276/1250 [===>................] - ETA: 96:03:10 - DT: 3.2716 - FpT: 760.0148 - BT: 767.1210 277/1250 [===>................] - ETA: 96:21:52 - DT: 3.2600 - FpT: 760.0357 - BT: 767.1371 278/1250 [===>................] - ETA: 96:40:17 - DT: 3.2485 - FpT: 760.0567 - BT: 767.1531 279/1250 [===>................] - ETA: 96:58:29 - DT: 3.2370 - FpT: 760.0776 - BT: 767.1691 280/1250 [===>................] - ETA: 97:16:45 - DT: 3.2256 - FpT: 760.0986 - BT: 767.1852 281/1250 [===>................] - ETA: 97:34:44 - DT: 3.2143 - FpT: 760.1197 - BT: 767.2014 282/1250 [===>................] - ETA: 97:52:21 - DT: 3.2031 - FpT: 760.1408 - BT: 767.2176 283/1250 [===>................] - ETA: 98:09:39 - DT: 3.1919 - FpT: 760.1619 - BT: 767.2337 284/1250 [===>................] - ETA: 98:26:48 - DT: 3.1808 - FpT: 760.1829 - BT: 767.2499 285/1250 [===>................] - ETA: 98:43:44 - DT: 3.1698 - FpT: 760.2038 - BT: 767.2660 286/1250 [===>................] - ETA: 99:00:35 - DT: 3.1589 - FpT: 760.2247 - BT: 767.2821 287/1250 [===>................] - ETA: 99:17:07 - DT: 3.1481 - FpT: 760.2456 - BT: 767.2982 288/1250 [===>................] - ETA: 99:33:38 - DT: 3.1373 - FpT: 760.2665 - BT: 767.3144 289/1250 [===>................] - ETA: 99:49:40 - DT: 3.1266 - FpT: 760.2874 - BT: 767.3305 290/1250 [===>................] - ETA: 100:05:46 - DT: 3.1160 - FpT: 760.3083 - BT: 767.3466 291/1250 [===>................] - ETA: 100:21:34 - DT: 3.1054 - FpT: 760.3293 - BT: 767.3628 292/1250 [===>................] - ETA: 100:37:05 - DT: 3.0950 - FpT: 760.3502 - BT: 767.3790 293/1250 [===>................] - ETA: 100:52:42 - DT: 3.0845 - FpT: 760.3712 - BT: 767.3952 294/1250 [===>................] - ETA: 101:08:00 - DT: 3.0742 - FpT: 760.3922 - BT: 767.4115 295/1250 [===>................] - ETA: 101:23:04 - DT: 3.0639 - FpT: 760.4133 - BT: 767.4278 296/1250 [===>................] - ETA: 101:37:58 - DT: 3.0537 - FpT: 760.4344 - BT: 767.4441